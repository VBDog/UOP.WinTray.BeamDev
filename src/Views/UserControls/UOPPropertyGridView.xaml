<UserControl x:Class="UOP.WinTray.UI.Views.UOPPropertyGridView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:UOP.WinTray.UI.Views" 
             xmlns:behaviors="clr-namespace:UOP.WinTray.UI.Behaviors"
             xmlns:autolocator ="clr-namespace:UOP.WinTray.UI"
             xmlns:md="https://github.com/fantasticfiasco/mvvm-dialogs" xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:con="clr-namespace:UOP.WinTray.UI.Converters"
               xmlns:viewmodels="clr-namespace:UOP.WinTray.UI.ViewModels"
            d:DataContext="{d:DesignInstance Type=viewmodels:UOPPropertyGridViewModel}"
             md:DialogServiceViews.IsRegistered="True"
             autolocator:ViewModelLocator.IsAutomaticLocator="True"                 
             mc:Ignorable="d" Loaded="UserControl_Loaded">
    <UserControl.Resources>
        
        <DataTemplate x:Key="ColumnInchHeaderTemplate">
            <StackPanel Orientation="Vertical" Width="auto">
                <TextBlock Text="{Binding}" Style="{StaticResource GridHeader}"/>
                <Border Background="#33B7FF" BorderBrush="Gray" BorderThickness="1">
                    <Label Style="{StaticResource LabelStyle1}"  Content="{Binding DataContext.LinearUnitsLabel,Mode=OneWay,UpdateSourceTrigger=PropertyChanged,RelativeSource={RelativeSource AncestorType=UserControl}}"/>
                </Border>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="ColumnInSqHeaderTemplate">
            <StackPanel Orientation="Vertical" Width="auto" VerticalAlignment="Bottom">
                <TextBlock Text="{Binding}" Style="{StaticResource GridHeader}"/>
                <Border Background="#33B7FF" BorderBrush="Gray" BorderThickness="1">
                    <Label Style="{StaticResource LabelStyle1}"  MinWidth ="5" Content="{Binding DataContext.AreaUnitsLabel,Mode=OneWay,UpdateSourceTrigger=PropertyChanged,RelativeSource={RelativeSource AncestorType=UserControl}}"/>
                </Border>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="ColumnPercentHeaderTemplate">
            <StackPanel Orientation="Vertical" VerticalAlignment="Bottom">
                <TextBlock Text="{Binding}" Style="{StaticResource GridHeader}"/>
                <Border Background="#33B7FF" BorderBrush="Gray" BorderThickness="1">
                    <Label Style="{StaticResource LabelStyle1}"  Content="%"/>
                </Border>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="ColumnNoHeaderTemplate">
            <StackPanel Orientation="Vertical" VerticalAlignment="Bottom">
                <TextBlock Text="{Binding}" Style="{StaticResource GridHeader}"/>
                <Border Background="#33B7FF" BorderBrush="Gray" BorderThickness="1">
                    <Label Style="{StaticResource LabelStyle1}"  Content=""/>
                </Border>
            </StackPanel>
        </DataTemplate>
        <Style TargetType="DataGridCell" x:Key="ActiveCellStyle">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="TextBlock.TextAlignment" Value="Center"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Err.ForeColor}" Value="{x:Null}">
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Err.ForeColor}" Value="Red">
                    <Setter Property="Foreground" Value="Red"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Err.ForeColor}" Value="Blue">
                    <Setter Property="Foreground" Value="Blue"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="DataGridCell" x:Key="ActiveIntTypeCellStyle">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="TextBlock.TextAlignment" Value="Center"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding No.ForeColor}" Value="{x:Null}">
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding No.ForeColor}" Value="Red">
                    <Setter Property="Foreground" Value="Red"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding No.ForeColor}" Value="Blue">
                    <Setter Property="Foreground" Value="Blue"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="DataGridCell" x:Key="CommonSyleForCell">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="TextBlock.TextAlignment" Value="Center"/>
        </Style>

    </UserControl.Resources>
    <GroupBox Style="{StaticResource GlobalGroupBoxStyle}" DataContext="{Binding DataContext,RelativeSource={RelativeSource AncestorType=UserControl}}">
        <StackPanel>
            <FrameworkElement x:Name="mdSpoutProxyElement" Width="0" Height="0" Visibility="{Binding VisibilityMDSpout}"/>
            <FrameworkElement x:Name="mdDrawProxyElement" Width="0" Height="0" Visibility="{Binding VisibilityMDDraw}"/>
            <DataGrid 
                ItemsSource="{Binding GridData}" 
                SelectedItem="{Binding SelectedItem,  Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                Name="downcomerGrid" 
                MinColumnWidth="48" 
                SelectionMode="Single" 
                CanUserAddRows="False" 
                CanUserResizeColumns="True" 
                SelectionChanged="Grid_SelectionChanged" 
                EnableRowVirtualization="False" EnableColumnVirtualization="False">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="MouseDoubleClick">
                        <i:InvokeCommandAction Command="{Binding Command_Edit}" CommandParameter="{Binding SelectedItem}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <DataGrid.Resources>
                    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFD500"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="Black"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="#FFD500"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="Black"/>
                    <Style BasedOn="{StaticResource {x:Type DataGridColumnHeader}}" TargetType="{x:Type DataGridColumnHeader}">
                        <Setter Property="Background" Value="#99ccff" />
                        <Setter Property="BorderBrush" Value="Black"/>
                        <Setter Property="BorderThickness" Value="0.5"/>
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Setter Property="VerticalContentAlignment" Value="Bottom"/>
                    </Style>
                </DataGrid.Resources>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="#" Binding="{Binding No.Value}"  FontSize="11" IsReadOnly="True" Width="10" HeaderTemplate="{StaticResource ColumnNoHeaderTemplate}" CellStyle="{StaticResource ActiveIntTypeCellStyle}" Visibility="{Binding DataContext.VisibilityMDSpout, Source={x:Reference mdSpoutProxyElement}}"/>
                    <DataGridTextColumn Header="Weir&#x0a;Length" Binding="{Binding WeirLength}"  FontSize="11" IsReadOnly="True" Width="auto" HeaderTemplate="{StaticResource ColumnInchHeaderTemplate}" CellStyle="{StaticResource CommonSyleForCell}" Visibility="{Binding DataContext.VisibilityMDSpout, Source={x:Reference mdSpoutProxyElement}}"/>
                    <DataGridTextColumn Header="Ideal&#x0a;Area" Binding="{Binding IdealArea}" FontSize="11" IsReadOnly="True" Width="auto" HeaderTemplate="{StaticResource ColumnInSqHeaderTemplate}" CellStyle="{StaticResource CommonSyleForCell}" Visibility="{Binding DataContext.VisibilityMDSpout, Source={x:Reference mdSpoutProxyElement}}"/>
                    <DataGridTextColumn Header="Actual&#x0a; Area" Binding="{Binding ActualArea}" FontSize="11" IsReadOnly="True" Width="auto" HeaderTemplate="{StaticResource ColumnInSqHeaderTemplate}" CellStyle="{StaticResource CommonSyleForCell}" Visibility="{Binding DataContext.VisibilityMDSpout, Source={x:Reference mdSpoutProxyElement}}"/>
                    <DataGridTextColumn Header="Err" Binding="{Binding Err.Value}"  FontSize="11" IsReadOnly="True" Width="auto" HeaderTemplate="{StaticResource ColumnPercentHeaderTemplate}" CellStyle="{StaticResource ActiveCellStyle}" Visibility="{Binding DataContext.VisibilityMDSpout, Source={x:Reference mdSpoutProxyElement}}"/>

                    <DataGridTextColumn Header="PN" Binding="{Binding PN}" FontSize="11" IsReadOnly="True" Width="10" HeaderTemplate="{StaticResource ColumnNoHeaderTemplate}" CellStyle="{StaticResource ActiveIntTypeCellStyle}" Visibility="{Binding DataContext.VisibilityMDDraw, Source={x:Reference mdDrawProxyElement}}"/>
                    <DataGridTextColumn Header="Box&#x0a;Length" Binding="{Binding BoxLength}" FontSize="11" IsReadOnly="True" Width="auto" HeaderTemplate="{StaticResource ColumnInchHeaderTemplate}" CellStyle="{StaticResource CommonSyleForCell}" Visibility="{Binding DataContext.VisibilityMDDraw, Source={x:Reference mdDrawProxyElement}}"/>
                    <DataGridTextColumn Header="Fld.&#x0a;Weir" Binding="{Binding FldWeir}" FontSize="11" IsReadOnly="True" Width="auto" HeaderTemplate="{StaticResource ColumnInchHeaderTemplate}" CellStyle="{StaticResource CommonSyleForCell}" Visibility="{Binding DataContext.VisibilityMDDraw, Source={x:Reference mdDrawProxyElement}}"/>
                    <DataGridTextColumn Header="Supl.&#x0a;Defl." Binding="{Binding SuplDefl}" FontSize="11" IsReadOnly="True" Width="auto" HeaderTemplate="{StaticResource ColumnInchHeaderTemplate}" CellStyle="{StaticResource CommonSyleForCell}" Visibility="{Binding DataContext.VisibilityMDDraw, Source={x:Reference mdDrawProxyElement}}"/>
                    <DataGridTextColumn Header="Gussets" Binding="{Binding Gussets}" FontSize="11" IsReadOnly="True" Width="auto" HeaderTemplate="{StaticResource ColumnNoHeaderTemplate}" CellStyle="{StaticResource ActiveCellStyle}" Visibility="{Binding DataContext.VisibilityMDDraw, Source={x:Reference mdDrawProxyElement}}"/>
                </DataGrid.Columns>
            </DataGrid>
        </StackPanel>
    </GroupBox>
</UserControl>
