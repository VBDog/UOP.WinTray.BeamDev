<Window x:Class="UOP.WinTray.UI.Views.Windows.Edit_MDDeckSplices_View"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:behaviors="clr-namespace:UOP.WinTray.UI.Behaviors"  
        xmlns:md="https://github.com/fantasticfiasco/mvvm-dialogs"
         xmlns:cntrls="clr-namespace:UOP.WinTray.UI.CustomControls.UserControls"
        md:DialogServiceViews.IsRegistered="True" 
        xmlns:conv="clr-namespace:UOP.WinTray.UI.Converters"
        xmlns:local="clr-namespace:UOP.WinTray.UI.Views.Windows"
        xmlns:dxfgraphiccontrol="clr-namespace:UOP.DXFGraphicsControl;assembly=UOP.DXFGraphicsControl"
               xmlns:viewmodels="clr-namespace:UOP.WinTray.UI.ViewModels"
        d:DataContext="{d:DesignInstance Type=viewmodels:Edit_MDDeckSplices_ViewModel}"
       
            
        mc:Ignorable="d"
        Style="{StaticResource PopUpWindowTheme}"
        WindowStartupLocation="CenterOwner"
        SizeToContent="WidthAndHeight"
        MinWidth="800" MinHeight="1000"
        MaxHeight="{x:Static SystemParameters.MaximizedPrimaryScreenHeight}"
        Loaded="Window_Loaded"
        Closing="Window_Closing"
        Unloaded="Window_Unloaded"
        KeyDown="Window_KeyDown"
        Title="Edit Deck Panel Splicing" d:DesignWidth="946.965">
    <Window.Resources>
        <conv:BooleanToVisibilityConverter x:Key="visibiliyConverter" ></conv:BooleanToVisibilityConverter>

    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="65"/>
            <RowDefinition Height="55"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="30*"/>
            <ColumnDefinition Width="53*"/>
            <ColumnDefinition Width="17*"/>
        </Grid.ColumnDefinitions>
        <Grid Grid.Row="0" Grid.Column="0" >
            <!-- Left panel -->
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <StackPanel Grid.Row="0" Orientation="Vertical" HorizontalAlignment="Stretch" Margin="2">
                <GroupBox Header="Tools" Margin="2" IsEnabled="{Binding IsEnabled}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="1*"/>
                            <RowDefinition Height="1*"/>
                            <RowDefinition Height="1*"/>
                            <RowDefinition Height="1*"/>
                            <RowDefinition Height="1*"/>
                            <RowDefinition Height="1*"/>
                            <RowDefinition Height="1*"/>
                            <RowDefinition Height="1*"/>
                            <RowDefinition Height="1*"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1*"/>
                            <ColumnDefinition Width="1*"/>
                        </Grid.ColumnDefinitions>
                        <DockPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Stretch">
                            <Label DockPanel.Dock="Left" Content="Splice Style:" Margin="2"/>
                            <ComboBox DockPanel.Dock="Right" Margin="2" ItemsSource="{Binding SpliceStyles}" SelectedIndex="{Binding SelectedSpliceStyle, Mode=TwoWay}" IsEnabled="{Binding IsEnabled}"/>
                        </DockPanel>
                        <Button Grid.Row="1" Grid.Column="0" Margin="2" Command="{Binding Command_GenerateUniform}" ToolTip="Apply a Uniform Panel Height To Generate the Splices">Generate: Uniform Ht.</Button>
                        <Button Grid.Row="2" Grid.Column="0" Margin="2" Command="{Binding Command_GenerateStradle}" ToolTip="Place Splices Above and Below the Edges of the Downcomers Below">Generate: Stradle DC</Button>
                        <Button Grid.Row="3" Grid.Column="0" Margin="2" Command="{Binding Command_CopyTray}" ToolTip="Copy The Splice Locations From Another Tray in the Project">Copy Tray Splices</Button>
                        <Button Grid.Row="4" Grid.Column="0" Margin="2" Command="{Binding Command_Add}" ToolTip="Add a Horizontal Splice To the Tray">Add Splice</Button>
                        <Button Grid.Row="5" Grid.Column="0" Margin="2" Command="{Binding Command_ManwayAdd}" ToolTip="Add a Manway to the Tray">Add Manway</Button>
                        <Button Grid.Row="6" Grid.Column="0" Margin="2" Command="{Binding Command_ManwayRemove}" ToolTip="Remove a Manway From the Tray">Remove Manway</Button>
                        <Button Grid.Row="7" Grid.Column="0" Margin="2" Command="{Binding Command_ManwaysRemove}" ToolTip="Remove Multiple Manways From the Tray">Remove Manways</Button>
                        <Button Grid.Row="8" Grid.Column="0" Margin="2" Command="{Binding Command_ManwaysResize}" ToolTip="Change the Manway Size">Resize Manways</Button>
                        <Button Grid.Row="1" Grid.Column="1" Margin="2" Command="{Binding Command_MoonSplit}" ToolTip="Add a Vertical Splice To the First Panel">Split Half Moon</Button>
                        <Button Grid.Row="2" Grid.Column="1" Margin="2" Command="{Binding Command_SetOrdinate}" ToolTip="Edit The Ordinate of the Selected Splice">Set Ordinate</Button>
                        <Button Grid.Row="3" Grid.Column="1" Margin="2" Command="{Binding Command_Delete}" ToolTip="Delete The Selected Splice">Delete</Button>
                        <Button Grid.Row="4" Grid.Column="1" Margin="2" Command="{Binding Command_Clear}" ToolTip="Delete All Defined Splices or the Splices on Selected Panels">Clear</Button>
                        <Button x:Name="cmdUndo" Grid.Row="5" Grid.Column="1" Margin="2" Command="{Binding Command_Undo}" IsEnabled="{Binding IsEnabled_Undo, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" ToolTip="Reset the Splices to the Last Configuration">Undo</Button>
                        <Button x:Name="cmdRedo" Grid.Row="6" Grid.Column="1" Margin="2" Command="{Binding Command_Redo}" IsEnabled="{Binding IsEnabled_Redo, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" ToolTip="Reverse the last Undo">Redo</Button>
                        <Button x:Name="cmdReset" Grid.Row="7" Grid.Column="1" Margin="2" Command="{Binding Command_Reset}" IsEnabled="{Binding IsEnabled_Reset, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"   ToolTip="Reset the Splices to the Configuration Currently Defined for the Tray Assembly">Reset</Button>
                        <Button Grid.Row="8" Grid.Column="1" Margin="2" Command="{Binding Command_Refresh}" ToolTip="Redraw The Display">Redraw</Button>
                    </Grid>
                </GroupBox>
                <GroupBox Header="Splices" Margin="2" IsEnabled="{Binding IsEnabled}">
                    <DataGrid Name="SplicesGrid" 
                              Margin="2" 
                              MaxHeight="150" 
                              VerticalScrollBarVisibility="Auto" 
                              AutoGenerateColumns="False" 
                              SelectionUnit="FullRow"
                              IsEnabled="{Binding IsEnabled}"
                              ItemsSource="{Binding SplicesDataGridItems}" 
                              SelectionChanged="SpliceDataGrid_SelectionChanged" 
                              SelectedItem="{Binding SelectedSpliceItem, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">
                        <DataGrid.Resources>
                            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#FFD500"/>
                            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="Black"/>
                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="#FFD500"/>
                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" Color="Black"/>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Splc." Binding="{Binding SpliceID}"/>
                            <DataGridTextColumn Header="Splice Type" Binding="{Binding SpliceType}"/>
                            <DataGridTextColumn Header="M/F" Binding="{Binding MOrF}"/>
                            <DataGridTextColumn Header="Ord." Binding="{Binding Ordinate}"/>
                            <DataGridTextColumn Header="Man. ID." Binding="{Binding ManwayID}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
                <GroupBox Header="Deck Sections" Margin="2" IsEnabled="{Binding IsEnabled}">
                    <DataGrid Margin="2" MaxHeight="150" VerticalScrollBarVisibility="Auto" AutoGenerateColumns="False" ItemsSource="{Binding DeckSectionsDataGridItems}" IsEnabled="{Binding IsEnabled}" >
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Sec." Binding="{Binding Section}"/>
                            <DataGridTextColumn Header="Manhole Fit Width" Binding="{Binding ManholeFitWidth}"/>
                            <DataGridTextColumn Header="Depth" Binding="{Binding Depth}"/>
                            <DataGridTextColumn Header="Base Height" Binding="{Binding BaseHeight}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>

            </StackPanel>
            <GroupBox Header="Info" Grid.Row="1" Margin="2">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch">
                    <TextBlock Foreground="Black" Text="{Binding ManholeIDText}" Margin="2"/>
                    <TextBlock Foreground="Black" Text="{Binding PanelFitLimitText}" Margin="2"/>
                    <TextBlock Foreground="Black" Text="{Binding IdealManwayHeightText}" Margin="2"/>
                    <TextBlock Foreground="{Binding ManwayHeightForegroundColor}" Text="{Binding ManwayHeightText}" Margin="2"/>
                    <TextBlock Foreground="{Binding ManwayCountForegroundColor}" Text="{Binding ManwayCountText}" Margin="2"/>
                    <TextBlock Foreground="Black" Text="{Binding DcSpaceText}" Margin="2"/>
                    <TextBlock Foreground="Black" Text="{Binding PanelWidthText}" Margin="2"/>

                </StackPanel>

            </GroupBox>

        </Grid>

        <Grid Grid.Column="1" Grid.ColumnSpan="2">
            <!-- Image section -->
            <Grid.RowDefinitions>
                <RowDefinition Height="10*" />
                <RowDefinition Height="90*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="85*" />
                <ColumnDefinition Width="15*" />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Row="0" Grid.Column="1" Grid.ZIndex="2" Orientation="Vertical">
                <!-- Check box overlay section -->
                <Label Content="{Binding ImageOverlayLabelText}"/>
                <Label Name="imageOverlayLocationLabel" Content="{Binding ImageOverlayLocationLabelText, UpdateSourceTrigger=PropertyChanged}" Visibility="Visible"/>
                <CheckBox x:Name="imageOverlayCheckbox" IsChecked="{Binding ImageOverlayCheckBoxIsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Visibility="Hidden">Maintain Symmetry</CheckBox>
            </StackPanel>
            <dxfgraphiccontrol:DXFViewer  
                Grid.Row="0" 
                Grid.Column="0" 
                Grid.RowSpan="2" 
                Grid.ColumnSpan="2" 
                Grid.ZIndex="1" 
                Background="DarkGray" 
                Margin="10,10,10,10" 
                Name="cadfxDXFViewer"
                IsEnabled="{Binding IsEnabled}"
                />
        </Grid>
        <Border
            Grid.Row="1" Grid.ColumnSpan="3" BorderBrush="Gray" BorderThickness="1"  Margin="3,0,10,0">
            <Grid Grid.Row="1" Grid.ColumnSpan="3" Margin="5">
                <!-- Save and Close buttons area -->
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="15*" />
                    <ColumnDefinition Width="70*" />
                    <ColumnDefinition Width="15*" />
                </Grid.ColumnDefinitions>
                <Button Name="cancleButton" 
                    Grid.Column="0" 
                    Margin="5,10,5,10" 
                    IsCancel="True"
                    IsEnabled="{Binding IsEnabled}"
                    Command="{Binding Command_Cancel}">Cancel</Button>
                <ToggleButton 
           CommandParameter="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
           Style="{StaticResource UnitsToggleButtonStyle_Small}"  
           IsChecked="{Binding IsEnglishSelected,Mode=TwoWay }"
           Grid.Row="2" Grid.Column="1"
           Height="20"
           FontSize="8"
           VerticalAlignment="Center"
           HorizontalAlignment="Center"
       Margin="5,5,5,5" 
           IsEnabled="{Binding IsEnabled}"
          Visibility="{Binding IsEnabled, Converter={StaticResource visibiliyConverter}}"
           />
                <Button Name="saveButton" IsEnabled="{Binding IsEnabled}" Grid.Column="2" Margin="5,10,5,10" Command="{Binding Command_Save}" >Save</Button>
            </Grid>
        </Border>

        <Grid Grid.Row="2" Grid.ColumnSpan="3">
            <!-- The status bar -->
            <Grid.Resources>
                <BooleanToVisibilityConverter x:Key="booleanToVisibilityConverter" />
            </Grid.Resources>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />

            </Grid.ColumnDefinitions>
            <Border BorderThickness="1"  Grid.Column="0" BorderBrush="Gray" Margin="3,0,0,3" MinWidth="450" HorizontalAlignment="Stretch">
                <TextBlock Grid.Column="0" Name="leftStatusBarLabel" Margin="5"  Text="{Binding LeftStatusBarLabelText}" VerticalAlignment="Center" HorizontalAlignment="Left"/>
            </Border>


            <Border BorderThickness="1"  Grid.Column="1" BorderBrush="Gray" Margin="0,0,10,3"  HorizontalAlignment="Stretch">

                <Grid Grid.Row="0" Grid.Column="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="50" />

                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions    >
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <!--<StackPanel  Orientation="Vertical"  Grid.Column="1">-->

                    <TextBlock Name="rightStatusBarLabel" FontSize="12"  Grid.Row="0" Margin="5"  Text="{Binding RightStatusBarLabelText}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                    <TextBlock Name="txtSubStatus"  FontSize="11"  Grid.Row="1" Margin="5" Text="{Binding SubStatusText}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                    <!--</StackPanel>-->
                    <Viewbox  Width="25"  Height="25" Grid.Column="2" Grid.RowSpan="2" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="3">
                        <cntrls:CircularProgressBar 
            Background="Transparent" 
              Visibility="{Binding ShowProgress, Converter={StaticResource booleanToVisibilityConverter}}"        
          />
                    </Viewbox>
                </Grid>
            </Border>
            <!--<ProgressBar Grid.Column="2" MinWidth="50" Name="progressBar" Margin="5" Visibility="{Binding ShowProgress, Converter={StaticResource booleanToVisibilityConverter}}" IsIndeterminate="True"/>-->
        </Grid>
    </Grid>
</Window>
