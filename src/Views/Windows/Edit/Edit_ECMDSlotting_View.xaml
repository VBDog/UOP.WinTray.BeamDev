<Window x:Class="UOP.WinTray.UI.Views.Windows.Edit_ECMDSlotting_View"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:UOP.WinTray.UI.Views.Windows"
        xmlns:dxfgraphiccontrol="clr-namespace:UOP.DXFGraphicsControl;assembly=UOP.DXFGraphicsControl"
          xmlns:cntrls="clr-namespace:UOP.WinTray.UI.CustomControls.UserControls"
        xmlns:vm="clr-namespace:UOP.WinTray.UI.ViewModels"
        d:DataContext="{d:DesignInstance Type=vm:Edit_ECMDSlotting_ViewModel}"
        mc:Ignorable="d"
        Style="{StaticResource PopUpWindowTheme}"
        WindowStartupLocation= "CenterOwner"
        SizeToContent="WidthAndHeight"
        ResizeMode="NoResize"
          Loaded="Window_Loaded"
Unloaded="Window_Unloaded"
         Closing="Window_Closing"
        Name="mainWindow"
        Title="{Binding Title}"
        IsEnabled="{Binding IsEnabled}"
        >
    <Window.Resources>
        <Style x:Key="focusedTextBoxStyle" TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="Background" Value="{Binding HighlightColor}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <!--<ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Margin="5,10,5,5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">-->
    <!--<Viewbox x:Name="vbMain" StretchDirection="Both"  HorizontalAlignment="Left" VerticalAlignment="Top"  MinHeight="700" Stretch="Uniform" >-->
    <Grid x:Name="grdMain" Margin="3" 
   
              >
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>

        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <!--<RowDefinition Height="35" />-->

        </Grid.RowDefinitions>
        <Grid x:Name="grdRow0" Margin="3" 
   
              >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>

            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>

                <!--<RowDefinition Height="35" />-->

            </Grid.RowDefinitions>
            <!-- Left panel -->
            <Border x:Name="bdrControls" BorderThickness="1" BorderBrush="Black" Margin="2" Visibility="Visible" 
             Width="350" HorizontalAlignment="Left" VerticalAlignment="Stretch" >

                <Grid x:Name="grdControls" HorizontalAlignment="Stretch" Margin="2" Height="Auto" MinWidth ="350" VerticalAlignment="Top">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="250*"/>
                    </Grid.ColumnDefinitions>
                    <!--<StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" Margin="2" Height="Auto" VerticalAlignment="Top">-->

                    <GroupBox Header="Controls" Grid.Row="0" Foreground="Blue" Margin="2" IsEnabled="{Binding ControlsPanelEnabled}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch">
                            <DockPanel HorizontalAlignment="Stretch">
                                <Label Content="Slot Type:" Margin="2"/>
                                <ComboBox Margin="2" MinWidth="100" ItemsSource="{Binding SlotType, UpdateSourceTrigger=PropertyChanged}" SelectedIndex="{Binding SelectedSlotTypeIndex}"/>
                            </DockPanel>
                            <DockPanel HorizontalAlignment="Stretch">
                                <Label Content="Functional Slotting [Fs]:" Margin="2"/>
                                <TextBox Margin="2" MinWidth="100" VerticalContentAlignment="Center" Text="{Binding FunctionalSlottingText}" Focusable="True" vm:FocusExtension.IsFocused="{Binding FunctionalSlottingTextBoxFocused}" IsReadOnly="True">
                                    <TextBox.InputBindings>
                                        <MouseBinding Command="{Binding Command_FunctionalSlottingTextBoxDoubleClick}" MouseAction="LeftDoubleClick"/>
                                    </TextBox.InputBindings>
                                </TextBox>
                            </DockPanel>
                        </StackPanel>
                    </GroupBox>
                    <GroupBox Header="Tray Information" Grid.Row="1" Foreground="Blue" Margin="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch">
                            <TextBlock Foreground="Black" Margin="1" Text="{Binding FunctionalAreaText}"/>
                            <TextBlock Foreground="Black" Margin="1" Text="{Binding SlotAreaText}"/>
                            <TextBlock Foreground="Black" Margin="1" Text="{Binding ActualSlottingPercentageText}"/>
                            <TextBlock Foreground="Black" Margin="1" Text="{Binding RequiredSlotCountText}"/>
                            <TextBlock Foreground="{Binding DeviationForegroundColor}" Margin="1" Text="{Binding ActualSlotCountText}"/>
                            <TextBlock Foreground="{Binding DeviationForegroundColor}" Margin="1" Text="{Binding CountDeviationText}"/>
                            <TextBlock Foreground="Black" Margin="1,10,0,0" Text="{Binding PanelSlotCountErrorLimitText}"/>
                            <TextBlock Foreground="Black" Margin="1" Text="{Binding TraySlotCountErrorLimitText}"/>
                            <!--<TextBlock Foreground="Black" Margin="1" Text="{Binding XPitchTextBlockText}"/>
                        <TextBlock Foreground="Black" Margin="1" Text="{Binding YPitchTextBlockText}"/>
                        <TextBlock Foreground="Black" Margin="1" Text="{Binding PitchTypeText}"/>-->
                        </StackPanel>
                    </GroupBox>
                    <GroupBox Header="Slot Generation" Grid.Row="2" Foreground="Blue" Margin="2" IsEnabled="{Binding SlotGenerationPanelEnabled}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch">
                            <DockPanel HorizontalAlignment="Stretch" Margin="2">
                                <Label Content="Target:"/>
                                <ComboBox Name="TargetCombo" ItemsSource="{Binding Target, UpdateSourceTrigger=PropertyChanged}" SelectedIndex="{Binding SelectedTargetIndex}" DropDownClosed="TargetCombo_DropDownClosed"/>
                            </DockPanel>
                            <Grid HorizontalAlignment="Stretch" Margin="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*"/>
                                    <ColumnDefinition Width="1*"/>
                                </Grid.ColumnDefinitions>
                                <DockPanel HorizontalAlignment="Stretch" Grid.Column="0" Margin="1">
                                    <Label Content="X Pitch:"/>
                                    <TextBox x:Name="xPitchTextBox" Text="{Binding XPitchTextBoxText}" VerticalContentAlignment="Center" vm:FocusExtension.IsFocused="{Binding XPitchTextBoxFocused}" Style="{StaticResource focusedTextBoxStyle}"  GotFocus="pitchTextBox_GotFocus"/>
                                </DockPanel>
                                <DockPanel HorizontalAlignment="Stretch" Grid.Column="1" Margin="1">
                                    <Label Content="Y Pitch:"/>
                                    <TextBox x:Name="yPitchTextBox" Text="{Binding YPitchTextBoxText}" VerticalContentAlignment="Center" vm:FocusExtension.IsFocused="{Binding YPitchTextBoxFocused}" Style="{StaticResource focusedTextBoxStyle}" GotFocus="pitchTextBox_GotFocus"/>
                                </DockPanel>
                            </Grid>
                            <!--<StackPanel Orientation="Horizontal" Margin="2">
                            <RadioButton Content="Triangular" Margin="0,2,2,2" IsChecked="{Binding TriangularRadioChecked}"/>
                            <RadioButton Content="Rectangular" Margin="2,2,0,2"/>
                        </StackPanel>-->
                            <Grid HorizontalAlignment="Stretch" Margin="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="1*"/>
                                    <RowDefinition Height="1*"/>
                                    <RowDefinition Height="1*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*"/>
                                    <ColumnDefinition Width="1*"/>
                                </Grid.ColumnDefinitions>
                                <CheckBox Grid.Column="0" Grid.Row="0" Margin="2" Grid.ColumnSpan="2" Content="Retain Suppressed Locations?" IsChecked="{Binding RetainSuppressedLocationChecked}"/>

                                <Button Grid.Column="0" Grid.Row="2" HorizontalAlignment="Stretch" Height="20" Margin="3,5,0,0" Command="{Binding Command_EstimatePitches}" ToolTip="Estimate The Ideal Pitch Values">Estimate Pitches</Button>
                                <Button Grid.Column="1" Grid.Row="2" HorizontalAlignment="Right" Width="70" Height="20" Margin="0,5,3,0" Command="{Binding Command_Apply}" ToolTip="Apply The Entered Pitch Values To the Target Slot Zones">Apply</Button>
                            </Grid>
                        </StackPanel>
                    </GroupBox>
                    <GroupBox Header="Slot Suppression" Grid.Row="3" Foreground="Blue" Margin="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <Grid HorizontalAlignment="Stretch" Margin="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="81*"/>
                                <ColumnDefinition Width="34*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="1*"/>
                                <RowDefinition Height="1*"/>
                                <RowDefinition Height="1*"/>
                            </Grid.RowDefinitions>
                            <CheckBox Grid.Row="0" Margin="2,2,2,2" Content="Enable Slot Suppression" IsChecked="{Binding SuppressionIsActive}"/>
                            <CheckBox Grid.Row="1" Margin="2,2,2,2" Content="Maintain Symmetry" IsChecked="{Binding MaintainSymmetry}"/>
                            <Button Grid.Row="1" Grid.Column="1" HorizontalAlignment="Center" Width="50" Height="18"   IsEnabled="{Binding ClearSuppressedAllowed}"  Command="{Binding Command_ClearSuppression}" ToolTip="Remove All Suppressed Slots" Margin="2"  >Clear</Button>
                            <TextBlock Grid.Row="2" Grid.ColumnSpan="2" HorizontalAlignment="Center" FontWeight="Bold" Text="Slot Suppression Is Active" Visibility="{Binding SuppressionIsVisible}" Margin="4" Width="144"  />
                        </Grid>
                    </GroupBox>
                    <GroupBox Header="Panels" Grid.Row="4" Foreground="Blue" Margin="2" HorizontalAlignment="Stretch" MinHeight="150" VerticalAlignment="Stretch">
                        <!--<Label Content="Panels:" Margin="2"/>-->
                        <DataGrid Margin="2" MaxHeight="250" VerticalScrollBarVisibility="Auto" CanUserResizeColumns="True" HorizontalAlignment="Stretch" VerticalAlignment="Top" AutoGenerateColumns="False" ItemsSource="{Binding PanelsDataGridItems}" SelectedIndex="{Binding SelectedPanelsDataGridIndex}" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="" Binding="{Binding RowNumber}">
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="Foreground" Value="{Binding RowNumberColor}"/>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Binding="{Binding TrayPercent}">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="{Binding DataContext.TrayPercentPanelHeader, RelativeSource={RelativeSource AncestorType=Window}}"/>
                                    </DataGridTextColumn.Header>
                                </DataGridTextColumn>
                                <DataGridTextColumn Binding="{Binding XPitch}">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="{Binding DataContext.XPitchPanelHeader, RelativeSource={RelativeSource AncestorType=Window}}" Margin="10,0,10,0"/>
                                    </DataGridTextColumn.Header>
                                </DataGridTextColumn>
                                <DataGridTextColumn Binding="{Binding YPitch}">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="{Binding DataContext.YPitchPanelHeader, RelativeSource={RelativeSource AncestorType=Window}}"/>
                                    </DataGridTextColumn.Header>
                                </DataGridTextColumn>
                                <!--<DataGridTextColumn Binding="{Binding PitchType}">
                            <DataGridTextColumn.Header>
                                <TextBlock Text="{Binding DataContext.PitchTypePanelHeader, RelativeSource={RelativeSource AncestorType=Window}}"/>
                            </DataGridTextColumn.Header>
                        </DataGridTextColumn>-->
                                <DataGridTextColumn Binding="{Binding RequiredCount}">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="{Binding DataContext.RequiredCountPanelHeader, RelativeSource={RelativeSource AncestorType=Window}}"/>
                                    </DataGridTextColumn.Header>
                                </DataGridTextColumn>
                                <DataGridTextColumn Binding="{Binding ActualCount}">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="{Binding DataContext.ActualCountPanelHeader, RelativeSource={RelativeSource AncestorType=Window}}"/>
                                    </DataGridTextColumn.Header>
                                </DataGridTextColumn>
                                <DataGridTextColumn Binding="{Binding CountError}">
                                    <DataGridTextColumn.Header>
                                        <TextBlock Text="{Binding DataContext.CountErrorPanelHeader, RelativeSource={RelativeSource AncestorType=Window}}"/>

                                    </DataGridTextColumn.Header>
                                    <DataGridTextColumn.CellStyle>
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="Foreground" Value="{Binding RowNumberColor}"/>
                                        </Style>
                                    </DataGridTextColumn.CellStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>
                    <GroupBox Header="Tools" Grid.Row="5" Foreground="Blue" Margin="2" HorizontalAlignment="Stretch" MinHeight="150" VerticalAlignment="Stretch">
                        <Grid HorizontalAlignment="Stretch" Margin="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="1*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="1*"/>
                                <RowDefinition Height="1*"/>
                                <RowDefinition Height="1*"/>
                                <RowDefinition Height="1*"/>
                            </Grid.RowDefinitions>
                            <Button Grid.Row="0" Grid.Column="0"  HorizontalAlignment="Stretch" Margin="10,5,10,5" Command="{Binding Command_Undo}">Undo</Button>

                            <Button Grid.Row="1" Grid.Column="0" HorizontalAlignment="Stretch" Margin="10,5,10,5" Command="{Binding Command_Redraw}" IsEnabled="{Binding IsEnabled}" ToolTip="Redraw Current View" >Redraw</Button>
                            <Button Grid.Row="1" Grid.Column="1" HorizontalAlignment="Stretch" Margin="10,5,10,5" Command="{Binding Command_Reset}" IsEnabled="{Binding IsEnabled}" ToolTip="Reset To Original Slot Confiuration" >Reset</Button>
                            <Button Grid.Row="2" Grid.Column="0" HorizontalAlignment="Stretch" Margin="10,5,10,5" IsCancel="True" Command="{Binding Command_Cancel}" ToolTip="Abandon Changes" >Cancel</Button>
                            <Button Grid.Row="2" Grid.Column="1" HorizontalAlignment="Stretch" Margin="10,5,10,5" Command="{Binding Command_Save}" IsEnabled="{Binding SaveButtonEnabled}" ToolTip="Save Current Configuration" >Save</Button>

                            <ToggleButton 
                            Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2"
                             CommandParameter="{Binding IsChecked, RelativeSource={RelativeSource Self}}"
                            Style="{StaticResource UnitsToggleButtonStyle_Small}"  
                            IsChecked="{Binding IsEnglishSelected,Mode=TwoWay }"
                            Height="20"
                            FontSize="8"
                            HorizontalAlignment="Center" 
                            Margin="0,3,0,10"
                            />
                        </Grid>
                    </GroupBox>
                    <!--</StackPanel>-->
                </Grid>
            </Border>
            <!-- VIEWER -->

            <Border x:Name="bdrViewer" Grid.Column="1" BorderThickness="1" BorderBrush="Black" Margin="0,0,1,0" Visibility="Visible" 
                 MinWidth="800" MinHeight="800"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                >
                <Grid x:Name="grdViewer" Grid.Column="1" Visibility="Visible">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <dxfgraphiccontrol:DXFViewer Name="cadfxDXFViewer" Grid.Row="0" Grid.Column="0" Grid.ZIndex="1" Background="Gray" Margin="5" Visibility="Visible" VerticalAlignment="Top" HorizontalAlignment="Left" MinWidth="800" MinHeight="800"/>
                    <Label Content="{Binding ImageOverlayLabelText}" Grid.ZIndex="2" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,25,0"/>
                </Grid>

            </Border>
        </Grid>
        <Grid  Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2">
            <!-- The status bar -->
            <Grid.Resources>
                <BooleanToVisibilityConverter x:Key="booleanToVisibilityConverter" />
            </Grid.Resources>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />

            </Grid.ColumnDefinitions>
            <Border BorderThickness="1"  Grid.Column="0" BorderBrush="Gray" Margin="3,0,0,3" MinWidth="450" HorizontalAlignment="Stretch">
                <TextBlock Grid.Column="0" Name="leftStatusBarLabel" Margin="5"  Text="{Binding LeftStatusBarLabelText}" VerticalAlignment="Center" HorizontalAlignment="Left"/>
            </Border>


            <Border BorderThickness="1"  Grid.Column="1" BorderBrush="Gray" Margin="0,0,10,3"  HorizontalAlignment="Stretch">

                <Grid Grid.Row="0" Grid.Column="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="50" />

                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions    >
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <!--<StackPanel  Orientation="Vertical"  Grid.Column="1">-->

                    <TextBlock Name="rightStatusBarLabel" FontSize="12"  Grid.Row="0" Margin="5"  Text="{Binding StatusText}"  Visibility="{Binding ShowProgress, Converter={StaticResource booleanToVisibilityConverter}}"  VerticalAlignment="Center" HorizontalAlignment="Right"/>
                    <TextBlock Name="txtSubStatus"  FontSize="11"  Grid.Row="1" Margin="5" Text="{Binding SubStatusText}"  Visibility="{Binding ShowProgress, Converter={StaticResource booleanToVisibilityConverter}}"  VerticalAlignment="Center" HorizontalAlignment="Right"/>
                    <!--</StackPanel>-->
                    <Viewbox  Width="25"  Height="25" Grid.Column="2" Grid.RowSpan="2" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="3">
                        <cntrls:CircularProgressBar 
      Background="Transparent" 
        Visibility="{Binding ShowProgress, Converter={StaticResource booleanToVisibilityConverter}}"        
    />
                    </Viewbox>
                </Grid>
            </Border>
            <!--<ProgressBar Grid.Column="2" MinWidth="50" Name="progressBar" Margin="5" Visibility="{Binding ShowProgress, Converter={StaticResource booleanToVisibilityConverter}}" IsIndeterminate="True"/>-->
        </Grid>
        <!-- The progress bar -->
        <!--
        <Border x:Name="bdrStatus" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"  BorderThickness="1" BorderBrush="Black" Margin="0,1,1,1"  Visibility="{Binding Visibility_Progress}"  Height="35"   MinHeight="35" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" >

            <Grid x:Name="grdStatus" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="250" />
                </Grid.ColumnDefinitions>

                <Label  Name="rightStatusBarLabel" Grid.Column="0" Margin="0,0,5,0" Content="{Binding StatusBarRightLabelText}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                <ProgressBar  Name="progressBar" Grid.Column="1" Margin="0,0,3,0" IsIndeterminate="True" HorizontalAlignment="Right" MinWidth="250"/>
            </Grid>
        </Border>-->
    </Grid>
    <!--</Viewbox>-->
    <!--</ScollViewer>-->
</Window>
